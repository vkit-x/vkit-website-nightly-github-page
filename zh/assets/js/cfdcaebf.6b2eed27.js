"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[184],{3905:function(e,n,t){t.d(n,{Zo:function(){return m},kt:function(){return f}});var a=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var p=a.createContext({}),c=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},m=function(e){var n=c(e.components);return a.createElement(p.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),d=c(t),f=i,k=d["".concat(p,".").concat(f)]||d[f]||u[f]||r;return t?a.createElement(k,l(l({ref:n},m),{},{components:t})):a.createElement(k,l({ref:n},m))}));function f(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,l=new Array(r);l[0]=d;var o={};for(var p in n)hasOwnProperty.call(n,p)&&(o[p]=n[p]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var c=2;c<r;c++)l[c]=t[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},8875:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return o},contentTitle:function(){return p},metadata:function(){return c},toc:function(){return m},default:function(){return d}});var a=t(3117),i=t(102),r=(t(7294),t(3905)),l=["components"],o={},p="\u57fa\u4e8e\u76f8\u673a\u6a21\u578b\u7684\u7578\u53d8",c={unversionedId:"feature/geometric-distortion/camera",id:"feature/geometric-distortion/camera",title:"\u57fa\u4e8e\u76f8\u673a\u6a21\u578b\u7684\u7578\u53d8",description:"cameracubiccurve",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/feature/geometric-distortion/camera.md",sourceDirName:"feature/geometric-distortion",slug:"/feature/geometric-distortion/camera",permalink:"/zh/feature/geometric-distortion/camera",editUrl:"https://github.com/vkit-x/vkit/edit/master/website/docs/feature/geometric-distortion/camera.md",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"\u4f7f\u7528\u793a\u4f8b",permalink:"/zh/feature/geometric-distortion/example"},next:{title:"\u57fa\u4e8e MLS \u7684\u7578\u53d8",permalink:"/zh/feature/geometric-distortion/mls"}},m=[{value:"camera_cubic_curve",id:"camera_cubic_curve",children:[],level:2},{value:"camera_plane_line_fold",id:"camera_plane_line_fold",children:[],level:2},{value:"camera_plane_line_curve",id:"camera_plane_line_curve",children:[],level:2}],u={toc:m};function d(e){var n=e.components,t=(0,i.Z)(e,l);return(0,r.kt)("wrapper",(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"\u57fa\u4e8e\u76f8\u673a\u6a21\u578b\u7684\u7578\u53d8"},"\u57fa\u4e8e\u76f8\u673a\u6a21\u578b\u7684\u7578\u53d8"),(0,r.kt)("h2",{id:"camera_cubic_curve"},"camera_cubic_curve"),(0,r.kt)("p",null,"\u63cf\u8ff0\uff1a\u5b9e\u73b0\u57fa\u4e8e\u76f8\u673a\u6a21\u578b\u7684\u4e0e\u4e09\u6b21\u51fd\u6570\u7684 3D \u66f2\u9762\u6548\u679c\uff0c\u53c2\u89c1 ",(0,r.kt)("a",{parentName:"p",href:"https://mzucker.github.io/2016/08/15/page-dewarping.html"},"Page dewarping")," \u6587\u4e2d\u63cf\u8ff0"),(0,r.kt)("p",null,"import:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from vkit.augmentation.geometric_distortion import (\n    CameraModelConfig,\n    CameraCubicCurveConfig,\n    camera_cubic_curve,\n)\n")),(0,r.kt)("p",null,"\u914d\u7f6e\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"@attr.define\nclass CameraModelConfig:\n    rotation_unit_vec: Sequence[float]\n    rotation_theta: float\n    principal_point: Optional[Sequence[float]] = None\n    focal_length: Optional[float] = None\n    camera_distance: Optional[float] = None\n\n\n@attr.define\nclass CameraCubicCurveConfig:\n    curve_alpha: float\n    curve_beta: float\n    # Clockwise, [0, 180]\n    curve_direction: float\n    curve_scale: float\n    camera_model_config: CameraModelConfig\n    grid_size: int\n")),(0,r.kt)("p",null,"\u5176\u4e2d\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"CameraModelConfig")," \u662f\u76f8\u673a\u6a21\u578b\u7684\u914d\u7f6e\uff08\u4e0b\u540c\uff09"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"rotation_unit_vec"),"\uff1a\u65cb\u8f6c\u5355\u4f4d\u5411\u91cf\uff0c\u5373\u65cb\u8f6c\u6307\u5411\u65b9\u5411\uff0c\u5177\u4f53\u89c1 ",(0,r.kt)("a",{parentName:"li",href:"https://docs.opencv.org/4.5.3/d9/d0c/group__calib3d.html#ga61585db663d9da06b68e70cfbf6a1eac"},"cv.Rodrigues")," \u91cc\u7684\u89e3\u91ca"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"rotation_theta"),"\uff1a\u65cb\u8f6c\u7684\u89d2\u5ea6\uff0c\u533a\u95f4 ",(0,r.kt)("inlineCode",{parentName:"li"},"[-180, 180]"),"\u3002\u89d2\u5ea6\u4e3a\u6b63\u6570\uff0c\u8868\u793a\u7684\u65b9\u5411\u4e0e\u53f3\u624b\u6cd5\u5219\u65cb\u8f6c\u65b9\u5411\u4e00\u81f4"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"principal_point"),"\uff1a\u53ef\u9009\u3002\u76f8\u673a\u6210\u50cf\u5149\u5b66\u8f74\uff08optical axis\uff09\u4e0e\u56fe\u7247\u7684\u76f8\u4ea4\u70b9\uff0c\u4f7f\u7528\u539f\u56fe\u7684\u5750\u6807\u8868\u793a\u3002\u5982\u679c\u4e0d\u63d0\u4f9b\uff0c\u9ed8\u8ba4\u4f1a\u8bbe\u5b9a\u4e3a\u56fe\u7247\u7684\u4e2d\u5fc3\u70b9"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"focal_length"),"\uff1a\u53ef\u9009\u3002\u76f8\u673a\u6210\u50cf\u5149\u5b66\u8f74\u7684\u7126\u8ddd\u3002\u5982\u679c\u4e0d\u63d0\u4f9b\uff0c\u4f1a\u91c7\u7528\u56fe\u50cf\u957f\u5bbd\u4e2d\u8f83\u5927\u503c\u4f5c\u4e3a\u7126\u8ddd"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"camera_distance"),"\uff1a\u53ef\u9009\u3002\u6307\u5b9a\u76f8\u673a\u5750\u6807\u539f\u70b9\u5230 ",(0,r.kt)("inlineCode",{parentName:"li"},"principal_point")," \u7684\u8ddd\u79bb\u3002\u5982\u679c\u4e0d\u63d0\u4f9b\uff0c\u4f1a\u57fa\u4e8e\u56fe\u7247\u4e0e\u6210\u50cf\u5c4f\u5e55\u76f8\u5207\u7684\u7b56\u7565\u51b3\u5b9a\u6b64\u8ddd\u79bb"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"CameraCubicCurveConfig")," \u63a7\u5236\u5982\u4f55\u751f\u6210\u66f2\u9762"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"curve_alpha"),"\uff1a\u6295\u5f71\u5de6\u7aef\u70b9\u7684\u659c\u7387"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"curve_beta"),"\uff1a\u6295\u5f71\u53f3\u7aef\u70b9\u7684\u659c\u7387"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"curve_direction"),"\uff1a\u6295\u5f71\u7ebf\u7684\u65b9\u5411\uff0c\u533a\u95f4 ",(0,r.kt)("inlineCode",{parentName:"li"},"[0, 180]"),"\u3002\u56fe\u7247\u4f1a\u6309\u7167\u8fd9\u4e2a\u65b9\u751f\u6210\u66f2\u9762\uff0c\u4f8b\u5982\u89d2\u5ea6\u4e3a ",(0,r.kt)("inlineCode",{parentName:"li"},"0")," \u65f6\u66f2\u9762\u7684\u201c\u8d77\u4f0f\u201d\u662f\u6a2a\u5411\u7684\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"90")," \u65f6\u4e3a\u7eb5\u5411\u3002\u57fa\u4e8e\u6295\u5f71\u4f4d\u7f6e\uff0c\u4f1a\u751f\u6210 Z \u8f74\u7684\u504f\u79fb\u91cf"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"curve_scale"),"\uff1a\u63a7\u5236 Z \u8f74\u7684\u504f\u79fb\u91cf\u7684\u653e\u5927\u500d\u6570\uff0c\u5efa\u8bae\u8bbe\u4e3a ",(0,r.kt)("inlineCode",{parentName:"li"},"1.0")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"grid_size"),"\uff1a\u7f51\u683c\u7684\u5927\u5c0f\uff0c\u4e0b\u540c\u3002\u7f51\u683c\u8d8a\u5c0f\uff0c\u51e0\u4f55\u7578\u53d8\u6548\u679c\u8d8a\u597d\uff0c\u6027\u80fd\u8d8a\u5dee")))),(0,r.kt)("p",null,"\u6548\u679c\u793a\u4f8b\uff1a"),(0,r.kt)("div",{align:"center"},(0,r.kt)("img",{alt:"camera_cubic_curve.gif",src:"https://i.loli.net/2021/11/25/B7Rpz46u5axO1sf.gif"})),(0,r.kt)("p",null,"\u5176\u4e2d\uff08\u4e0b\u540c\uff09\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5de6\u4e0a\uff1a\u5f62\u53d8\u540e\u56fe\u7247\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"Image")),(0,r.kt)("li",{parentName:"ul"},"\u53f3\u4e0a\uff1a\u5f62\u53d8\u540e\u591a\u8fb9\u5f62\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"Polygon")),(0,r.kt)("li",{parentName:"ul"},"\u5de6\u4e2d\uff1a\u5f62\u53d8\u540e\u56fe\u50cf\u5e73\u9762\u7f51\u683c\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"ImageGrid")),(0,r.kt)("li",{parentName:"ul"},"\u53f3\u4e2d\uff1a\u56fe\u50cf ",(0,r.kt)("inlineCode",{parentName:"li"},"active_image_mask")," \u8499\u677f\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"ImageMask")),(0,r.kt)("li",{parentName:"ul"},"\u5de6\u4e0b\uff1a\u5f62\u53d8\u540e\u56fe\u50cf\u8499\u7248\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"ImageMask")),(0,r.kt)("li",{parentName:"ul"},"\u53f3\u4e0b\uff1a\u5f62\u53d8\u540e\u8bc4\u5206\u56fe\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"ImageScoreMap"))),(0,r.kt)("h2",{id:"camera_plane_line_fold"},"camera_plane_line_fold"),(0,r.kt)("p",null,"\u63cf\u8ff0\uff1a\u5b9e\u73b0\u57fa\u4e8e\u76f8\u673a\u6a21\u578b\u4e0e\u57fa\u51c6\u7ebf\u7684\u7ffb\u6298\u6548\u679c\uff0c\u53c2\u89c1 ",(0,r.kt)("a",{parentName:"p",href:"https://www3.cs.stonybrook.edu/~cvl/docunet.html"},"DocUNet: Document Image Unwarping via A Stacked U-Net")," \u6587\u4e2d\u63cf\u8ff0"),(0,r.kt)("p",null,"import:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from vkit.augmentation.geometric_distortion import (\n    CameraModelConfig,\n    CameraPlaneLineFoldConfig,\n    camera_plane_line_fold,\n)\n")),(0,r.kt)("p",null,"\u914d\u7f6e\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"@attr.define\nclass CameraPlaneLineFoldConfig:\n    fold_point: Tuple[float, float]\n    # Clockwise, [0, 180]\n    fold_direction: float\n    fold_perturb_vec: Tuple[float, float, float]\n    fold_alpha: float\n    camera_model_config: CameraModelConfig\n    grid_size: int\n")),(0,r.kt)("p",null,"\u5176\u4e2d\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fold_point"),"  \u4e0e  ",(0,r.kt)("inlineCode",{parentName:"li"},"fold_direction"),"  \u51b3\u5b9a\u57fa\u51c6\u7ebf\u3002 ",(0,r.kt)("inlineCode",{parentName:"li"},"fold_point"),"  \u8bbe\u4e3a\u539f\u56fe\u7684\u67d0\u4e2a\u70b9\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"fold_direction")," \u4e3a\u4ece\u8be5\u70b9\u51fa\u53d1\u7684\u57fa\u51c6\u7ebf\u89d2\u5ea6\uff0c\u987a\u65f6\u9488\u533a\u503c\u533a\u95f4 ",(0,r.kt)("inlineCode",{parentName:"li"},"[0, 180]")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fold_perturb_vec"),"\uff1a\u4e3a\u4e09\u7ef4\u6270\u52a8\u5411\u91cf\u3002\u56fe\u4e2d\u7684\u70b9\u4e0e\u57fa\u51c6\u7ebf\u8d8a\u63a5\u8fd1\uff0c\u6270\u52a8\u8d8a\u5f3a\uff0c\u5373 ",(0,r.kt)("inlineCode",{parentName:"li"},"p + w * fold_perturb_vec")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fold_alpha"),"\uff1a \u63a7\u5236 ",(0,r.kt)("inlineCode",{parentName:"li"},"w = fold_alpha / (fold_alpha + d)"),"\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"d")," \u4e3a\u70b9\u5230\u7ffb\u6298\u7ebf\u7684\u5f52\u4e00\u5316\u8ddd\u79bb\u3002",(0,r.kt)("inlineCode",{parentName:"li"},"fold_alpha")," \u7684\u53d6\u503c\u8d8a\u9760\u8fd1 ",(0,r.kt)("inlineCode",{parentName:"li"},"0"),"\uff0c\u7ffb\u6298\u6548\u679c\u8d8a\u5f3a\u3002\u63a8\u8350\u53d6\u503c ",(0,r.kt)("inlineCode",{parentName:"li"},"0.5"))),(0,r.kt)("p",null,"\u6548\u679c\u793a\u4f8b\uff1a"),(0,r.kt)("div",{align:"center"},(0,r.kt)("img",{alt:"camera_plane_line_fold.gif",src:"https://i.loli.net/2021/11/25/FLicMRwuA1tynrg.gif"})),(0,r.kt)("h2",{id:"camera_plane_line_curve"},"camera_plane_line_curve"),(0,r.kt)("p",null,"\u63cf\u8ff0\uff1a\u5b9e\u73b0\u57fa\u4e8e\u76f8\u673a\u6a21\u578b\u7684\u4e0e\u57fa\u51c6\u7ebf\u7684\u66f2\u9762\u6548\u679c\uff0c\u53c2\u89c1 ",(0,r.kt)("a",{parentName:"p",href:"https://www3.cs.stonybrook.edu/~cvl/docunet.html"},"DocUNet: Document Image Unwarping via A Stacked U-Net")," \u6587\u4e2d\u63cf\u8ff0"),(0,r.kt)("p",null,"import:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from vkit.augmentation.geometric_distortion import (\n    CameraModelConfig,\n    CameraPlaneLineCurveConfig,\n    camera_plane_line_curve,\n)\n")),(0,r.kt)("p",null,"\u914d\u7f6e\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"@attr.define\nclass CameraPlaneLineCurveConfig:\n    curve_point: Tuple[float, float]\n    # Clockwise, [0, 180]\n    curve_direction: float\n    curve_perturb_vec: Tuple[float, float, float]\n    curve_alpha: float\n    camera_model_config: CameraModelConfig\n    grid_size: int\n\n")),(0,r.kt)("p",null,"\u5176\u4e2d\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"curve_point"),"  \u4e0e  ",(0,r.kt)("inlineCode",{parentName:"li"},"curve_direction"),"  \u51b3\u5b9a\u57fa\u51c6\u7ebf\uff0c\u540c ",(0,r.kt)("inlineCode",{parentName:"li"},"CameraPlaneLineFoldConfig")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"curve_perturb_vec"),"\uff1a\u4e3a\u4e09\u7ef4\u6270\u52a8\u5411\u91cf\u3002\u540c ",(0,r.kt)("inlineCode",{parentName:"li"},"CameraPlaneLineFoldConfig")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"curve_alpha"),"\uff1a \u63a7\u5236 ",(0,r.kt)("inlineCode",{parentName:"li"},"w = 1 - d^curve_alpha"),"\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"d")," \u4e3a\u70b9\u5230\u57fa\u51c6\u7ebf\u7684\u5f52\u4e00\u5316\u8ddd\u79bb\u3002",(0,r.kt)("inlineCode",{parentName:"li"},"curve_alpha"),"  \u8d8a\u5c0f\uff0c\u8d8a\u63a5\u8fd1\u7ffb\u6298\u7684\u6548\u679c\u3002\u63a8\u8350\u53d6\u503c ",(0,r.kt)("inlineCode",{parentName:"li"},"2.0"))),(0,r.kt)("p",null,"\u6548\u679c\u793a\u4f8b\uff1a"),(0,r.kt)("div",{align:"center"},(0,r.kt)("img",{alt:"camera_plane_line_curve.gif",src:"https://i.loli.net/2021/11/26/xcCPAUbZDflO3wj.gif"})))}d.isMDXComponent=!0}}]);